{% extends "admin/base.html" %}
{% load static %}

{% block title %}Django商城后台管理 - 控制台{% endblock %}

{% block content %}
<div class="dashboard">
    <!-- 统计卡片 -->
    <el-row :gutter="20">
        <el-col :span="6">
            <el-card class="stat-card">
                <div class="stat-content">
                    <div class="stat-icon">
                        <i class="el-icon-goods"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-number">{{ product_count|default:"0" }}</div>
                        <div class="stat-label">商品总数</div>
                    </div>
                </div>
            </el-card>
        </el-col>
        <el-col :span="6">
            <el-card class="stat-card">
                <div class="stat-content">
                    <div class="stat-icon">
                        <i class="el-icon-s-order"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-number">{{ order_count|default:"0" }}</div>
                        <div class="stat-label">订单总数</div>
                    </div>
                </div>
            </el-card>
        </el-col>
        <el-col :span="6">
            <el-card class="stat-card">
                <div class="stat-content">
                    <div class="stat-icon">
                        <i class="el-icon-user"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-number">{{ user_count|default:"0" }}</div>
                        <div class="stat-label">用户总数</div>
                    </div>
                </div>
            </el-card>
        </el-col>
        <el-col :span="6">
            <el-card class="stat-card">
                <div class="stat-content">
                    <div class="stat-icon">
                        <i class="el-icon-money"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-number">{{ revenue|default:"¥0" }}</div>
                        <div class="stat-label">总收入</div>
                    </div>
                </div>
            </el-card>
        </el-col>
    </el-row>
    
    <!-- 图表和表格 -->
    <el-row :gutter="20" style="margin-top: 20px;">
        <el-col :span="12">
            <el-card>
                <div slot="header">
                    <span>最近订单</span>
                    <el-button style="float: right; padding: 3px 0" type="text" @click="viewAllOrders">
                        查看全部
                    </el-button>
                </div>
                <el-table :data="recentOrders" style="width: 100%" :show-header="true">
                    <el-table-column prop="id" label="订单号" width="120"></el-table-column>
                    <el-table-column prop="status" label="状态" width="100">
                        <template slot-scope="scope">
                            <el-tag :type="getStatusType(scope.row.status)" size="small">
                                {{ scope.row.status }}
                            </el-tag>
                        </template>
                    </el-table-column>
                    <el-table-column prop="total" label="金额" width="100"></el-table-column>
                    <el-table-column prop="created_at" label="创建时间"></el-table-column>
                </el-table>
            </el-card>
        </el-col>
        <el-col :span="12">
            <el-card>
                <div slot="header">
                    <span>系统信息</span>
                </div>
                <el-descriptions :column="1" border>
                    <el-descriptions-item label="Django版本">4.2.7</el-descriptions-item>
                    <el-descriptions-item label="Python版本">3.8+</el-descriptions-item>
                    <el-descriptions-item label="数据库">MySQL</el-descriptions-item>
                    <el-descriptions-item label="服务器时间">{{ server_time }}</el-descriptions-item>
                    <el-descriptions-item label="系统状态">
                        <el-tag type="success" size="small">运行正常</el-tag>
                    </el-descriptions-item>
                </el-descriptions>
            </el-card>
        </el-col>
    </el-row>
    
    <!-- 快捷操作 -->
    <el-row :gutter="20" style="margin-top: 20px;">
        <el-col :span="24">
            <el-card>
                <div slot="header">
                    <span>快捷操作</span>
                </div>
                <el-row :gutter="20">
                    <el-col :span="6">
                        <el-button type="primary" icon="el-icon-plus" @click="addProduct" style="width: 100%; height: 60px;">
                            添加商品
                        </el-button>
                    </el-col>
                    <el-col :span="6">
                        <el-button type="success" icon="el-icon-s-order" @click="viewOrders" style="width: 100%; height: 60px;">
                            查看订单
                        </el-button>
                    </el-col>
                    <el-col :span="6">
                        <el-button type="warning" icon="el-icon-user" @click="manageUsers" style="width: 100%; height: 60px;">
                            用户管理
                        </el-button>
                    </el-col>
                    <el-col :span="6">
                        <el-button type="info" icon="el-icon-setting" @click="systemSettings" style="width: 100%; height: 60px;">
                            系统设置
                        </el-button>
                    </el-col>
                </el-row>
            </el-card>
        </el-col>
    </el-row>
</div>

<script>
// 扩展Vue实例的方法
new Vue({
    el: '#app',
    methods: {
        // 查看所有订单
        viewAllOrders() {
            window.location.href = '/admin/orders/order/';
        },
        
        // 添加商品
        addProduct() {
            window.location.href = '/admin/products/product/add/';
        },
        
        // 查看订单
        viewOrders() {
            window.location.href = '/admin/orders/order/';
        },
        
        // 用户管理
        manageUsers() {
            window.location.href = '/admin/auth/user/';
        },
        
        // 系统设置
        systemSettings() {
            this.$message.info('系统设置功能开发中...');
        }
    }
});
</script>
{% endblock %} 